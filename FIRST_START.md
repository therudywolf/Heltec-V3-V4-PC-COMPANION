# Первый запуск · rudywolf

Пошаговый гайд: от нуля до работающего монитора на дисплее Heltec.

---

## Шаг 1. LibreHardwareMonitor на ПК

1. Скачай [LibreHardwareMonitor](https://github.com/LibreHardwareMonitor/LibreHardwareMonitor/releases) и распакуй.
2. Запусти **LibreHardwareMonitor.exe**.
3. В меню: **Options → Run LibreHardwareMonitor** (чтобы работал в трее).
4. Включи веб-сервер: **Options → Remote Web Server** (порт по умолчанию 8085).
5. Проверь в браузере: `http://localhost:8085/data.json` — должен открыться JSON с метриками.

Если порт другой — запомни его, он понадобится в `.env` как `LHM_URL`.

---

## Шаг 2. Клонирование и конфиг проекта

1. Открой папку проекта (например `Heltec v4` или `rudywolf`).
2. Создай конфиг из шаблона:

   ```bash
   copy .env.example .env
   ```

3. Открой `.env` в блокноте. Основные параметры:

   | Переменная | Значение                          | Описание                                                                    |
   | ---------- | --------------------------------- | --------------------------------------------------------------------------- |
   | `LHM_URL`  | `http://localhost:8085/data.json` | URL JSON от LibreHardwareMonitor                                            |
   | `TCP_PORT` | `8888`                            | Порт TCP-сервера (к нему подключается плата)                                |
   | `PC_IP`    | IP твоего ПК в сети               | Нужен только для справки; в плату вписывается отдельно в `config_private.h` |

   Узнать IP ПК: в cmd выполни `ipconfig`, смотри «IPv4-адрес» нужного адаптера (WiFi или Ethernet).

---

## Шаг 3. Установка зависимостей и запуск монитора

1. Открой терминал (cmd или PowerShell) в папке проекта.
2. Установи зависимости:

   ```bash
   pip install -r requirements.txt
   ```

3. Запусти сервер:

   ```bash
   python monitor.py
   ```

4. В консоли должно появиться что-то вроде:

   ```
   [INIT] Запуск мониторинга...
   [*] TCP: 0.0.0.0:8888
   ```

   Окно не закрывай — монитор ждёт подключения платы.

---

## Шаг 4. Подготовка платы Heltec

1. Скопируй конфиг WiFi:

   ```bash
   copy config_private.h.example config_private.h
   ```

2. Открой `config_private.h` и заполни:

   | Параметр    | Пример            | Описание                        |
   | ----------- | ----------------- | ------------------------------- |
   | `WIFI_SSID` | `"MyWiFi"`        | Имя точки доступа               |
   | `WIFI_PASS` | `"MyPassword"`    | Пароль WiFi                     |
   | `PC_IP`     | `"192.168.1.100"` | **IPv4-адрес ПК** в той же сети |
   | `TCP_PORT`  | `8888`            | Порт (такой же, как в `.env`)   |

   Важно: `PC_IP` — это IP твоего компьютера, который ты узнал на шаге 2. Плата будет подключаться по TCP к этому адресу и порту.

3. Открой **main.cpp** в Arduino IDE или PlatformIO.
4. Выбери плату **Heltec WiFi Kit 32** (или совместимую ESP32 с SSD1306).
5. Собери проект и залей прошивку в плату.

---

## Шаг 5. Подключение и проверка

1. Убедись, что на ПК запущен **monitor.py** (консоль открыта).
2. Плата должна быть включена и в зоне WiFi.
3. Через несколько секунд после загрузки прошивки Heltec подключится к WiFi и к TCP-серверу.
4. На дисплее появятся экраны с метриками. В правом верхнем углу будет «W» (WiFi).

Если данные не появляются:

- Проверь, что LibreHardwareMonitor запущен и веб-сервер включён.
- Проверь, что `PC_IP` в `config_private.h` совпадает с реальным IP ПК.
- Убедись, что брандмауэр не блокирует входящие на порт 8888 (или отключи его для теста).
- В консоли monitor.py при подключении платы должно появиться: `[TCP] Подключён ...`

---

## Шаг 6. Управление на дисплее

- **Короткое нажатие** кнопки — переключение экранов (Main → Cores → GPU → … → Network → снова Main).
- **Долгое нажатие** — открыть меню. В меню:
  - Короткое нажатие — переход по пунктам (LED → AUTO → EQ Style → EXIT).
  - Долгое нажатие на пункте — изменить значение (вкл/выкл LED, автосмену, стиль эквалайзера) или выйти (EXIT).

Меню само закроется через 5 минут без действий.

---

## Дальше

- **Автозапуск монитора:** [AUTOSTART.md](AUTOSTART.md)
- **Один exe вместо Python:** выполни `build_exe.bat`, используй `dist\monitor.exe` вместе с `.env`

Готово. Если что-то пошло не так — сверься с [README.md](README.md) и проверь конфиги и порты.
