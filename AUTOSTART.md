# Автозапуск Heltec PC Monitor в Windows

## Вариант 1: Папка «Автозагрузка»

1. Положи в одну папку: `monitor.py`, `.env`, зависимости — или собранный `monitor.exe` и `.env`.
2. Создай ярлык на `run_monitor.bat` (с консолью), на `run_monitor.vbs` (без окна) или на `monitor.exe` (без консоли, только иконка в трее).
3. Нажми Win+R, введи `shell:startup`, Enter.
4. Скопируй ярлык в открывшуюся папку «Автозагрузка».

При каждом входе в систему монитор будет запускаться.

## Вариант 2: Планировщик заданий (Task Scheduler)

1. Открой «Планировщик заданий» (taskschd.msc).
2. Создать задачу → Имя: «Heltec Monitor».
3. Вкладка «Общие»: включи «Выполнять с наивысшими правами» при необходимости.
4. Вкладка «Триггеры» → Создать → «При входе в систему».
5. Вкладка «Действия» → Создать:
   - Программа: полный путь к `pythonw.exe` (или к `monitor.exe`, если собрал).
   - Аргументы: `monitor.py` (для pythonw) или пусто для exe.
   - Рабочая папка: папка, где лежит `monitor.py` (или `monitor.exe`) и `.env`.
6. ОК.

Так монитор будет запускаться в фоне без окна.

## Сборка одного EXE (PyInstaller)

**Рекомендуемый способ — один скрипт:**

```bash
build_oneclick.bat
```

Скрипт создаёт `.venv`, ставит все зависимости из `requirements.txt` и PyInstaller, собирает по `monitor.spec` (без консоли, с иконкой в трее) и копирует `monitor.exe` в корень проекта. Положи рядом `.env` и при необходимости добавь ярлык на `monitor.exe` в «Автозагрузку» или задачу в Планировщике (рабочая папка — каталог с `.env`). EXE работает без окна — только иконка в трее; выход: правый клик по иконке → Выход.

**Вручную:**

```bash
pip install -r requirements.txt
pyinstaller --noconfirm monitor.spec
```

Готовый `monitor.exe` будет в папке `dist/`. Скопируй его в каталог с `.env`.
